'use strict';var _createClass=function(){function a(b,c){for(var f,d=0;d<c.length;d++)f=c[d],f.enumerable=f.enumerable||!1,f.configurable=!0,'value'in f&&(f.writable=!0),Object.defineProperty(b,f.key,f)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _asyncToGenerator(a){return function(){var b=a.apply(this,arguments);return new Promise(function(c,d){function f(g,h){try{var j=b[g](h),k=j.value}catch(l){return void d(l)}return j.done?void c(k):Promise.resolve(k).then(function(l){f('next',l)},function(l){f('throw',l)})}return f('next')})}}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var Gluipertje=function(){function a(_ref){var b=_ref.host,c=_ref.port;_classCallCheck(this,a),this.baseurl=b+':'+c+'/api'}return _createClass(a,[{key:'getAllUsers',value:function(){var c=_asyncToGenerator(regeneratorRuntime.mark(function d(){return regeneratorRuntime.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.t0=this.constructor,g.next=3,this.constructor.fetchJSON({url:this.baseurl+'/users'});case 3:return g.t1=g.sent,g.next=6,g.t0.parseUser.call(g.t0,g.t1);case 6:return g.abrupt('return',g.sent);case 7:case'end':return g.stop();}},d,this)}));return function b(){return c.apply(this,arguments)}}()},{key:'getUserById',value:function(){var c=_asyncToGenerator(regeneratorRuntime.mark(function d(f){return regeneratorRuntime.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.t0=this.constructor,h.next=3,this.constructor.fetchJSON({url:this.baseurl+'/user/'+f});case 3:return h.t1=h.sent,h.next=6,h.t0.parseUser.call(h.t0,h.t1);case 6:return h.abrupt('return',h.sent);case 7:case'end':return h.stop();}},d,this)}));return function b(){return c.apply(this,arguments)}}()},{key:'getUserByToken',value:function(){var c=_asyncToGenerator(regeneratorRuntime.mark(function d(f){return regeneratorRuntime.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.t0=this.constructor,h.next=3,this.constructor.fetchJSON({url:this.baseurl+'/'+f+'/me'});case 3:return h.t1=h.sent,h.next=6,h.t0.parseUser.call(h.t0,h.t1);case 6:return h.abrupt('return',h.sent);case 7:case'end':return h.stop();}},d,this)}));return function b(){return c.apply(this,arguments)}}()},{key:'revokeToken',value:function(){var c=_asyncToGenerator(regeneratorRuntime.mark(function d(f){var g=f.username,h=f.password;return regeneratorRuntime.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return k.next=2,this.constructor.postJSON({url:this.baseurl+'/token',data:{username:g,password:h}});case 2:return k.abrupt('return',k.sent);case 3:case'end':return k.stop();}},d,this)}));return function b(){return c.apply(this,arguments)}}()},{key:'createUser',value:function(){var c=_asyncToGenerator(regeneratorRuntime.mark(function d(f){var g=f.nickname,h=f.username,j=f.password;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.t0=this.constructor,l.next=3,this.constructor.postJSON({url:this.baseurl+'/users',data:{nickname:g,username:h,password:j}});case 3:return l.t1=l.sent,l.next=6,l.t0.parseUser.call(l.t0,l.t1);case 6:return l.abrupt('return',l.sent);case 7:case'end':return l.stop();}},d,this)}));return function b(){return c.apply(this,arguments)}}()},{key:'getAllMessages',value:function(){var c=_asyncToGenerator(regeneratorRuntime.mark(function d(){return regeneratorRuntime.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.t0=this.constructor,g.next=3,this.constructor.fetchJSON({url:this.baseurl+'/messages'});case 3:return g.t1=g.sent,g.next=6,g.t0.parseMessage.call(g.t0,g.t1);case 6:return g.abrupt('return',g.sent);case 7:case'end':return g.stop();}},d,this)}));return function b(){return c.apply(this,arguments)}}()},{key:'getMessageById',value:function(){var c=_asyncToGenerator(regeneratorRuntime.mark(function d(f){return regeneratorRuntime.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.t0=this.constructor,h.next=3,this.constructor.fetchJSON({url:this.baseurl+'/message/'+f});case 3:return h.t1=h.sent,h.next=6,h.t0.parseMessage.call(h.t0,h.t1);case 6:return h.abrupt('return',h.sent);case 7:case'end':return h.stop();}},d,this)}));return function b(){return c.apply(this,arguments)}}()},{key:'getMessagesByLimit',value:function(){var c=_asyncToGenerator(regeneratorRuntime.mark(function d(f){return regeneratorRuntime.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.t0=this.constructor,h.next=3,this.constructor.fetchJSON({url:this.baseurl+'/messages/'+f});case 3:return h.t1=h.sent,h.next=6,h.t0.parseMessage.call(h.t0,h.t1);case 6:return h.abrupt('return',h.sent);case 7:case'end':return h.stop();}},d,this)}));return function b(){return c.apply(this,arguments)}}()},{key:'getLastMessage',value:function(){var c=_asyncToGenerator(regeneratorRuntime.mark(function d(){return regeneratorRuntime.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.getMessagesByLimit(1);case 2:return g.abrupt('return',g.sent[0]);case 3:case'end':return g.stop();}},d,this)}));return function b(){return c.apply(this,arguments)}}()},{key:'sendMessage',value:function(){var c=_asyncToGenerator(regeneratorRuntime.mark(function d(f){var g=f.token,h=f.body;return regeneratorRuntime.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return k.t0=this.constructor,k.next=3,this.constructor.postJSON({url:this.baseurl+'/messages',data:{token:g,body:h}});case 3:return k.t1=k.sent,k.next=6,k.t0.parseMessage.call(k.t0,k.t1);case 6:return k.abrupt('return',k.sent);case 7:case'end':return k.stop();}},d,this)}));return function b(){return c.apply(this,arguments)}}()}],[{key:'fetchJSON',value:function(){var c=_asyncToGenerator(regeneratorRuntime.mark(function d(f){var h,j,g=f.url;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,fetch(g);case 2:return h=l.sent,l.next=5,h.json();case 5:return j=l.sent,l.abrupt('return',j);case 7:case'end':return l.stop();}},d,this)}));return function b(){return c.apply(this,arguments)}}()},{key:'postJSON',value:function(){var c=_asyncToGenerator(regeneratorRuntime.mark(function d(f){var j,g=f.url,h=f.data;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,fetch(g,{method:'POST',body:JSON.stringify(h),headers:new Headers({'Content-Type':'application/json'})});case 2:return j=l.sent,l.next=5,j.json();case 5:return l.abrupt('return',l.sent);case 6:case'end':return l.stop();}},d,this)}));return function b(){return c.apply(this,arguments)}}()},{key:'parseUser',value:function(){var c=_asyncToGenerator(regeneratorRuntime.mark(function d(f){var g,h,j,k,l,m,o,p,q;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!(f.constructor===Array&&0<f.length)){s.next=35;break}g=f,h=[],j=!0,k=!1,l=void 0,s.prev=6,m=g[Symbol.iterator]();case 8:if(j=(o=m.next()).done){s.next=18;break}return p=o.value,s.t0=h,s.next=13,this.constructor.parseUser(p);case 13:s.t1=s.sent,s.t0.push.call(s.t0,s.t1);case 15:j=!0,s.next=8;break;case 18:s.next=24;break;case 20:s.prev=20,s.t2=s['catch'](6),k=!0,l=s.t2;case 24:s.prev=24,s.prev=25,!j&&m.return&&m.return();case 27:if(s.prev=27,!k){s.next=30;break}throw l;case 30:return s.finish(27);case 31:return s.finish(24);case 32:return s.abrupt('return',h);case 35:if(!(f.constructor===String&&0<f.length)){s.next=48;break}return s.prev=36,s.next=39,this.constructor.parseUser(JSON.parse(f));case 39:return s.abrupt('return',s.sent);case 42:return s.prev=42,s.t3=s['catch'](36),console.log(s.t3),s.abrupt('return',f);case 46:s.next=65;break;case 48:if(f.constructor!==Object){s.next=64;break}return s.prev=49,q=f,q.created_at=new Date(q.created_at),q.updated_at=new Date(q.updated_at),q.deleted_at=new Date(q.deleted_at),'Invalid Date'==q.deleted_at&&delete q.deleted_at,s.abrupt('return',q);case 58:return s.prev=58,s.t4=s['catch'](49),console.log(s.t4),s.abrupt('return',f);case 62:s.next=65;break;case 64:return s.abrupt('return',f);case 65:case'end':return s.stop();}},d,this,[[6,20,24,32],[25,,27,31],[36,42],[49,58]])}));return function b(){return c.apply(this,arguments)}}()},{key:'parseMessage',value:function(){var c=_asyncToGenerator(regeneratorRuntime.mark(function d(f){var g,h,j,k,l,m,o,p,q;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!(f.constructor===Array&&0<f.length)){s.next=35;break}g=f,h=[],j=!0,k=!1,l=void 0,s.prev=6,m=g[Symbol.iterator]();case 8:if(j=(o=m.next()).done){s.next=18;break}return p=o.value,s.t0=h,s.next=13,this.parseMessage(p);case 13:s.t1=s.sent,s.t0.push.call(s.t0,s.t1);case 15:j=!0,s.next=8;break;case 18:s.next=24;break;case 20:s.prev=20,s.t2=s['catch'](6),k=!0,l=s.t2;case 24:s.prev=24,s.prev=25,!j&&m.return&&m.return();case 27:if(s.prev=27,!k){s.next=30;break}throw l;case 30:return s.finish(27);case 31:return s.finish(24);case 32:return s.abrupt('return',h);case 35:if(!(f.constructor===String&&0<f.length)){s.next=48;break}return s.prev=36,s.next=39,this.parseMessage(JSON.parse(f));case 39:return s.abrupt('return',s.sent);case 42:return s.prev=42,s.t3=s['catch'](36),console.log(s.t3),s.abrupt('return',f);case 46:s.next=66;break;case 48:if(f.constructor!==Object){s.next=65;break}return s.prev=49,q=f,q.created_at=new Date(q.created_at),q.updated_at=new Date(q.updated_at),q.deleted_at=new Date(q.deleted_at),'Invalid Date'==q.deleted_at&&delete q.deleted_at,delete q.from_id,s.abrupt('return',q);case 59:return s.prev=59,s.t4=s['catch'](49),console.log(s.t4),s.abrupt('return',f);case 63:s.next=66;break;case 65:return s.abrupt('return',f);case 66:case'end':return s.stop();}},d,this,[[6,20,24,32],[25,,27,31],[36,42],[49,59]])}));return function b(){return c.apply(this,arguments)}}()}]),a}();try{module.exports=Gluipertje}catch(a){console.log(a)}
